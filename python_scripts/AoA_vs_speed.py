import numpy as np
from pyquaternion import Quaternion
import numpy.polynomial.polynomial as poly
import matplotlib.pyplot as plt

windspeed = range(0,21); # m/s

angle_quat = np.array([[-1.0, -2.30743e-09, -3.90027e-09, -7.91908e-10], # 0
                       [-0.99961, 8.18342e-06, 0.02769, -0.00029], # 1
                       [-0.99848,  6.44337e-05, 0.05506, -0.00116], # 2
                       [-0.99664, 0.00021, 0.08183, -0.00257], # 3
                       [-0.99416, 0.00048, 0.10774, -0.00446], #4
                       [-0.99115,  0.00089, 0.13253, -0.00673], # 5
                       [-0.98766, 0.00148, 0.15626, -0.00937], # 6
                       [-0.98383, 0.00221, 0.17866, -0.01221], # 7
                       [-0.97972, 0.00311, 0.19973, -0.01527], # 8
                       [-0.97542, 0.00414, 0.21950, -0.01842], # 9
                       [-0.97101, 0.00529, 0.23798, -0.02160], # 10
                       [-0.96653, 0.00656, 0.25525, -0.02485], # 11
                       [-0.96204, 0.00789, 0.27133, -0.02802], # 12
                       [-0.95756, 0.00932, 0.28638, -0.03118], # 13
                       [-0.95314, 0.01080, 0.30036, -0.03427], # 14
                       [-0.94880, 0.01231, 0.31341, -0.03727], # 15
                       [-0.94455, 0.01384, 0.32558, -0.04017], # 16
                       [-0.94041, 0.01540, 0.33694, -0.04298], # 17
                       [-0.93638, 0.01695, 0.34756, -0.04568], # 18
                       [-0.93247, 0.01851, 0.35750, -0.04828], # 19
                       [-0.92869, 0.02005, 0.36680, -0.05077]]); # 20

angles = np.zeros(angle_quat.shape[0]);

for i in windspeed:
    quat = Quaternion(angle_quat[i]);
    angles[i] = -quat.radians;

plt.plot(windspeed, angles, 'bo');

coefs = poly.polyfit(windspeed, angles, 2)
x_new = np.linspace(0, 20, 100);
ffit = poly.polyval(x_new, coefs);
plt.plot(x_new, ffit)

plt.xlabel('Windspeed (m/s)')
plt.ylabel('Angle of attack (radians)')
plt.show();
